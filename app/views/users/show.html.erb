<!DOCTYPE html>
<html lang="ja">

    <head>
        <meta charset="UTF-8">
        <meta neme="viewport" content="width=device-width, initial-scale=1">
        <title>GD match</title>
        <link rel="stylesheet" href="../../assets/stylesheets/html5reset-1.6.1.css">

    </head>

    <body>
        <br>
        <div class="userpage-all-container">
            <div class="user-prof-container" align="center">
                <div class="userpage-head" align="center">
                    <p><b>ユーザー情報</b></p>
                </div>
                <br>
                <div class="follow-button" align="center">
                    <% if @user.id == current_user.id %>
                    <% else %>
                    <% if current_user.following?(@user) %>
                    <%= button_to "フォロー解除", user_relationships_path(@user.id), method: :delete %>
                    <% else %>
                    <%= button_to "フォロー", user_relationships_path(@user.id), method: :post %>
                    <% end %>
                    <% end %>
                </div>
                <br>
                <div class="user-info" align="center">
                    <table>
                        <tbody>
                            <tr>
                                <th>名前</th>
                                <td>&nbsp;&nbsp;</td>
                                <td><%= @user.name %></td>
                            </tr>
                            <tr>
                                <th>メールアドレス</th>
                                <td>&nbsp;&nbsp;</td>
                                <td><%= @user.email %></td>
                            </tr>
                            <tr>
                                <th>プロフィール</th>
                                <td>&nbsp;&nbsp;</td>
                                <td><%= @user.profile %></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <br>
                <% if current_user.id == @user.id %>
                <%= link_to "編集", edit_user_registration_path %>
                <% else %>
                <% if @isRoom == true %>
                <p><a class="dm-button" href="/rooms/<%= @roomId %>"><button>ダイレクトメッセージ</button></a><br>
                    <% else %>
                    <%= form_for @room do |f| %>
                    <%= fields_for @entry do |e| %>
                    <%= e.hidden_field :user_id, :value=> @user.id %>
                    <% end %>
                    <%= f.submit "ダイレクトメッセージ" %>
                    <% end %>
                    <% end %>
                    <% end %>
                    <br>
            </div>

            <div class="user-tweets-container" align="center">
                <div class="userpage-tweets-list" align="center">
                    <p><b>ユーザーの投稿一覧</b></p>
                </div>
                <br>
                <table class="user-tweets-table">
                    <tbody>
                        <tr>
                            <th>テーマ型</th>
                            <th>テーマ</th>
                            <th>開催日時</th>
                            <th>グループ人数</th>
                            <th>レベル</th>
                            <th>詳細ページ</th>
                        </tr>
                        <% @user.tweets.each do |t| %>
                        <tr>
                            <td><%= t.thematype %></td>
                            <td><%= t.thema %></td>
                            <td><%= t.hosttime %></td>
                            <td><%= t.number %>名</td>
                            <td><%= t.level %></td>
                            <td><%= button_to " 詳細 ", tweet_path(t.id) %></td>
                        </tr>
                        <% end %>
                    </tbody>
                </table>
                <br>
            </div>
            <br>

            <div class="user-likes-container" align="center">
                <div class="userpage-tweets-likes" align="center">
                    <p><b>ユーザーがいいねした投稿一覧</b></p>
                </div>
                <br>
                <table class="user-likes-table">
                    <tbody>
                        <tr>
                            <th>テーマ型</th>
                            <th>テーマ</th>
                            <th>開催日時</th>
                            <th>グループ人数</th>
                            <th>レベル</th>
                            <th>ユーザー名</th>
                            <th>詳細ページ</th>
                        </tr>
                        <% @user.liked_tweets.each do |t| %>
                        <tr>
                            <td><%= t.thematype %></td>
                            <td><%= t.thema %></td>
                            <td><%= t.hosttime %></td>
                            <td><%= t.number %>名</td>
                            <td><%= t.level %></td>
                            <td><%= t.user.name %></td>
                            <td><%= button_to " 詳細 ", tweet_path(t.id) %></td>
                        </tr>
                        <% end %>
                    </tbody>
                </table>
                <br>
            </div>

            <br>

            <div class="user-follow-container" align="center">
                <div class="userpage-tweets-likes" align="center">
                    <p><b>フォロワーまたはフォローユーザー</b></p>
                </div>
                <br>
                <% if @users.present? %>
                <table class="user-follow-table">
                    <thead>
                        <tr>
                            <th>ユーザー名</th>
                            <th>フォロー</th>
                            <th>フォロワー</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% @users.each do |user| %>
                        <tr>
                            <td><a href="/users/<%= user.id %>"><%= user.name %></a></td>
                            <td><%= user.followings.count %>名</td>
                            <td><%= user.followers.count %>名</td>
                        </tr>
                        <% end %>
                    </tbody>
                </table>
                <% else %>
                <p>ユーザーはいません</p>
                <% end %>
                <br>
            </div>

            <br>

            <div class="user-take-container" align="center">
                <% if @user.id == current_user.id %>
                <div class="userpage-take-all" align="center">
                    <p><b>あなたの申込一覧</b></p>
                </div>
                <br>
                <%# <% @user.taked_tweets.each do |tt| %>
                <%# # <p><%= tt.thema %></p>
                <%# <% end %>
                <%# <% else %>
                <% end %>
            </div>

            <br>
        </div>
        <div align="center">
            <%= link_to "Tweet一覧に戻る", tweets_path %>
        </div>

        <br>
        <br>
        <br>
        <br>
    </body>

</html>